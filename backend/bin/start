#!/bin/sh

mkdir -p export

# Log created SQL queries
# https://github.com/postgraphql/postgraphql/issues/525#issuecomment-317273045
# export DEBUG="*:sql" 
# export DEBUG="graphile-build:warn"

# Relevant configurations:
# - Binding the service to be reachable at ...
#     - localhost
#     - 0.0.0.0 (all interfaces of the host)
#     - some.host.name
# - Connection to PostgreSQL, specifying username, host, port and database name

postgraphile \
    --host localhost \
    --connection postgres://me@localhost:5432/$MEDIATUM_DATABASE_NAME \
    --schema api,debug \
    --cors  \
    --export-schema-json export/schema-export.json \
    --export-schema-graphql export/schema-export.graphql \
    --watch \
    --no-setof-functions-contain-nulls \
    --legacy-relations=omit \
    --no-ignore-rbac \

#     --dynamic-json \
