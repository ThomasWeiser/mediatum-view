#!/bin/sh

# Run graphqelm utility to autogenerate Elm code for type-safe GraphQL queries.
# GraphQL backend needs to be running for this!
# https://github.com/dillonkearns/graphqelm

rm -rf gen
graphqelm http://localhost:5000/graphql --base Graphql --output gen/

# Prepare a clean build.
rm -rf elm-stuff/build-artifacts
bin/elm package install --yes

# Apply patch necessary for integration with chromium's "Redux DevTools Extension"
# https://github.com/utkarshkukreti/elm-remotedev
patch --strip=0 --forward <patch-elm-remotedev

# Compile the Elm code
bin/elm make --output=elm.js src/Main.elm
